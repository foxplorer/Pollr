"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createNonce = void 0;
const mod_js_1 = require("../../../mod.js");
/**
 * Creates a nonce derived from a wallet
 * @param wallet
 * @param counterparty - The counterparty to the nonce creation. Defaults to 'self'.
 * @returns A random nonce derived with a wallet
 */
async function createNonce(wallet, counterparty = 'self') {
    // Generate 16 random bytes for the first half of the data
    const firstHalf = (0, mod_js_1.Random)(16);
    // Create an sha256 HMAC
    const { hmac } = await wallet.createHmac({
        protocolID: [2, 'server hmac'],
        keyID: mod_js_1.Utils.toUTF8(firstHalf),
        data: firstHalf,
        counterparty
    });
    // Concatenate firstHalf and secondHalf as the nonce bytes
    const nonceBytes = [...firstHalf, ...hmac];
    return mod_js_1.Utils.toBase64(nonceBytes);
}
exports.createNonce = createNonce;
//# sourceMappingURL=createNonce.js.map